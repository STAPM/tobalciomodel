prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs()
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
multipliers <- multipliers()
names(multipliers)
View(multipliers)
devtools::load_all()
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs()
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
### Extract the multipliers
multipliers <- multipliers()
names(multipliers)
policy_sim*multipliers[,"output.multipliers.type1"]
summary(multipliers)
multipliers$output.multipliers.type1 <- as.numeric(as.character(multipliers$output.multipliers.type1))
summary(multipliers)
names(multipliers)
devtools::load_all()
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs()
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
### Extract the multipliers
multipliers <- multipliers()
devtools::load_all()
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs()
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
### Extract the multipliers
multipliers <- multipliers()
devtools::load_all()
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs()
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
### Extract the multipliers
multipliers <- multipliers()
summary(multipliers)
policy_sim*multipliers[,"output.multipliers.type1"]
output.effects <- policy_sim*multipliers[,"output.multipliers.type1"]
output.effects <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
output.effects <- policy_sim*multipliers[,"output.multipliers.type1"]
output.effects
policy_sim
rm(list = ls())
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs()
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
### Extract the multipliers
multipliers <- multipliers()
### Output effects
output.effects <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = FALSE)
### Extract the multipliers
multipliers <- multipliers()
### Output effects
output.effects <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
### see the effect of the random splitting of the on-trade
reps <- 1000
effects.vector <- rep(NA,1000)
for (i in 1:reps) {
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
effects.vector[i] <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
}
data <- data.frame(effects.vector)
names(data)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density()
library(tidyverse)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density()
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy")
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors")
### see the effect of the random splitting of the on-trade
reps <- 10000
effects.vector <- rep(NA,10000)
for (i in 1:reps) {
print(paste0("Simulation Iteration: ",i))
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
effects.vector[i] <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
}
library(tidyverse)
data <- data.frame(effects.vector)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors")
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5) +
geom_vline(xintercept = output.effects) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors")
### see the effect of the random splitting of the on-trade
reps <- 100000
effects.vector <- rep(NA,100000)
for (i in 1:reps) {
print(paste0("Simulation Iteration: ",i))
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = c(0,0,0,0,0),
reallocate = FALSE,
prob = TRUE)
effects.vector[i] <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
}
library(tidyverse)
data <- data.frame(effects.vector)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5) +
geom_vline(xintercept = output.effects) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors")
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5) +
geom_vline(xintercept = output.effects) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors") +
scale_x_continuous(breaks - seq(-3.3,0.05,-2.9), minor_breaks = NULL)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5) +
geom_vline(xintercept = output.effects) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors") +
scale_x_continuous(breaks = seq(-3.3,0.05,-2.9), minor_breaks = NULL)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.5) +
geom_vline(xintercept = output.effects) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors") +
scale_x_continuous(breaks = seq(-3.3,-2.9,0.05), minor_breaks = NULL)
ggplot(data=data) +
aes(x = effects.vector) +
geom_density(fill="navy",alpha=0.4) +
geom_vline(xintercept = output.effects) +
theme_minimal() +
labs(y = "Density",
x = "Effect on Output (£bn)",
title = "Effect of a 10% Fall in Consumption of On-Trade Alcohol Products",
subtitle = "Distribution of Effects when Varying Split Across Two On-Trade Sectors") +
scale_x_continuous(breaks = seq(-3.3,-2.9,0.05), minor_breaks = NULL)
library(tobalciomodel)
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs(yr = 2018,
scotland = FALSE,
elasticity = "meng14")
data <- inputs
alc.policy = "exog"
off.trade.ch = c(0,0,0,0,0)
on.trade.ch <- rep(-0.1,5)
prob = FALSE
## Initialise a vector to store the changes in final demand
final.demand <- rep(0,106)
## Model an Exogenous change to consumption -------
if (alc.policy == "exog") {
# add modelled changes into the dataset
data <- data.frame(data,on.trade.ch,off.trade.ch)
data2 <- data %>%
dplyr::mutate(Q.Change.on = Consumption.On*on.trade.ch) %>%
dplyr::mutate(Q.Change.off = Consumption.Off*off.trade.ch) %>%
dplyr::mutate(C.Change.on = Q.Change.on*Price.On) %>%
dplyr::mutate(C.Change.off = Q.Change.off*Price.Off) %>%
dplyr::select(C.Change.on,C.Change.off) %>%
dplyr::mutate(tot.change.on = sum(C.Change.on)) %>%
dplyr::mutate(tot.change.off = sum(C.Change.off)) %>%
dplyr::select(tot.change.on,tot.change.off) %>%
dplyr::distinct()
data2 <- as.vector(as.matrix(data2))
}
## Model a minimum unit price (MUP) -------
if (alc.policy == "MUP") {
}
## Model a tax change -------
if (alc.policy == "MUP") {
}
## Save out results -------
# off-trade changes go into sector 61 - Wholesale Trade (Alcohol)
final.demand[61] <- data2[2]
# on-trade changes equally split between 69 - Accommodation (Alcohol) and 71 - Food and Beverage (Alcohol)
if (prob == FALSE) {
final.demand[69] <- data2[1]*0.5
final.demand[71] <- data2[1]*0.5
} else if (prob == TRUE) {
split <- runif(1)
final.demand[69] <- data2[1]*split
final.demand[71] <- data2[1]*(1-split)
}
direct.effect <- sum(final.demand)
names(tobalciomodel::iotable)
hhold.prop <- tobalciomodel::iotable$hhold.demand / sum(tobalciomodel::iotable$hhold.demand)
sum(hhold.prop)
reallocated.demand <- direct.effect*hhold.prop
reallocated.demand <- -1*(direct.effect*hhold.prop)
sum(reallocated.demand)
direct.effect
adjusted.final.demand <- reallocated.demand + final.demand
library(tobalciomodel)
rm(list = ls())
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs(yr = 2018,
scotland = FALSE,
elasticity = "meng14")
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = rep(-0.1,5),
reallocate = FALSE,
prob = FALSE)
policy_sim_re <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = rep(-0.1,5),
reallocate = TRUE,
prob = FALSE)
library(tobalciomodel)
library(data.table)
library(dplyr)
### Select data and parameters
inputs <- final_demand_inputs(yr = 2018,
scotland = FALSE,
elasticity = "meng14")
### Simulate a policy
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = rep(0,5),
reallocate = FALSE,
prob = FALSE)
policy_sim_re <- simulate_alcohol_policy(data = inputs,
alc.policy = "exog",
on.trade.ch = rep(-0.1,5),
off.trade.ch = rep(0,5),
reallocate = TRUE,
prob = FALSE)
output.effects.1 <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
output.effects.2 <- sum(policy_sim*multipliers[,"output.multipliers.type2"])
output.effects.1.re <- sum(policy_sim_re*multipliers[,"output.multipliers.type1"])
output.effects.2.re <- sum(policy_sim_re*multipliers[,"output.multipliers.type2"])
### Extract the multipliers
multipliers <- multipliers(yr = 2018,
empl = "fte")
### Output effects
output.effects.1 <- sum(policy_sim*multipliers[,"output.multipliers.type1"])
output.effects.2 <- sum(policy_sim*multipliers[,"output.multipliers.type2"])
output.effects.1.re <- sum(policy_sim_re*multipliers[,"output.multipliers.type1"])
output.effects.2.re <- sum(policy_sim_re*multipliers[,"output.multipliers.type2"])
help(package=tobalciomodel)
library(tobalciomodel)
names(tobalciomodel::iotable)
?iotable
