)))
devtools::document()
rm(list = ls())
library(tobalciomodel)
data <- select_scenario(5)
View(data)
library(tobalciomodel)
scenario <- scenario_select(5)
devtools::document()
devtools::load_all(".")
library(tobalciomodel)
scenario <- scenario_select(5)
help(package="tobalciomodel")
scenario <- select_scenario(5)
inputs <- final_demand_inputs(yr = scenario[["year"]],
scotland = scenario[["scotland"]],
elasticity = scenario[["elasticity"]])
library(tobalciomodel)
library(data.table)
library(dplyr)
inputs <- final_demand_inputs(yr = scenario[["year"]],
scotland = scenario[["scotland"]],
elasticity = scenario[["elasticity"]])
inputs <- final_demand_inputs(yr =         scenario[["year"]],
scotland =   scenario[["scotland"]],
elasticity = scenario[["elasticity"]])
policy_sim <- simulate_alcohol_policy(data = inputs,
alc.policy   = scenario[["alc.policy"]],
on.trade.ch  = scenario[["alc.on.ex"]],
off.trade.ch = scenario[["alc.off.ex"]],
prob = FALSE)
multipliers <- multipliers(yr =    scenario[["year"]],
empl =  scenario[["emp.measure"]])
output <- impact_calculate(demand.change = policy_sim,
multipliers = multipliers)
output
View(inputs)
alcohol <- ifelse(scenario[["alc.policy"]] %in% c("exog","MUP","tax"),TRUE,FALSE)
tobacco <- ifelse(scenario[["tob.policy"]] %in% c("exog","MUP","tax"),TRUE,FALSE)
devtools::document()
library(tobalciomodel)
help(package=tobalciomodel)
consumption <- readxl("data-raw/consumertrendsq12020cvmsa.xls")
?read_excel
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35")
View(consumption)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
colnames = FALSE)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)]
View(consumption)
library(readxl)
library(dplyr)
consumption <- consumption[,c(1,7)] %>%
rename(...1 = year)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)] %>%
rename(...1 = year)
consumption <- consumption[,c(1,7)] %>%
rename(year = ...1)
View(consumption)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)] %>%
rename(year = ...1,
consumption = ...7)
rm(list = ls())
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
rename(year = ...1) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
View(habits.prevalance)
View(habits.prevalance)
summary(habits.prevalance)
substr(habits.prevalance$year,1,4)
as.numeric(substr(habits.prevalance$year,1,4))
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
mutate(year = as.numeric(...1,1,4))) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
mutate(year = as.numeric(...1,1,4))) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
mutate(year = as.numeric(...1,1,4)) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
mutate(year = as.numeric(...1,1,4)) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
mutate(year = as.numeric(...1,1,4))
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
mutate(year = as.numeric(substr(...1,1,4)))
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
rename(year = ...1) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
rename(year = ...1) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance$year <-  substr(year,1,4))
habits.prevalance$year <- as.numeric(substr(habits.prevalance$year,1,4))
summary(habits.prevalance)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)] %>%
rename(year = ...1,
consumption = ...7) %>%
mutate(consumption.gb = consumption*0.98)
habits.ncigs <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 4",
range = "A27:U48",
col_names = FALSE)
View(habits.ncigs)
habits.ncigs <- habits.ncigs[-c(19,20),c(1,21)]
habits.ncigs <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 4",
range = "A27:U48",
col_names = FALSE)
habits.ncigs <- habits.ncigs[-c(19,20),c(1,21)] %>%
rename(year = ...1,
ncigs = ...21) %>%
mutate(prevalance = ...21/100)
habits.ncigs$year <- as.numeric(substr(habits.ncigs$year,1,4))
### number of cigarettes smoked
habits.ncigs <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 4",
range = "A27:U48",
col_names = FALSE)
habits.ncigs <- habits.ncigs[-c(19,20),c(1,21)] %>%
rename(year = ...1,
ncigs = ...21)
habits.ncigs$year <- as.numeric(substr(habits.ncigs$year,1,4))
habits.type <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 5",
range = "A11:O16",
col_names = FALSE)
habits.type <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 5",
range = "A11:O16",
col_names = FALSE)
habits.type <- habits.type %>%
rename(...1 = year) %>%
mutate(ryo.prop = (...13+...15)/100) %>%
mutate(fm.prop = (...12+...14)/100) %>%
select(year,ryo.prop,fm.prop)
habits.type <- habits.type %>%
rename(year = ...1) %>%
mutate(ryo.prop = (...13+...15)/100) %>%
mutate(fm.prop = (...12+...14)/100) %>%
select(year,ryo.prop,fm.prop)
population  <- read_excel("data-raw/mesas-monitoring-report-2020-alcohol-sales-price-and-affordability.xlsx",
sheet = "Population data",
range = "B5:D26",
col_names = FALSE)
population  <- read_excel("data-raw/mesas-monitoring-report-2020-alcohol-sales-price-and-affordability.xlsx",
sheet = "Population data",
range = "B5:D26",
col_names = FALSE)
population <- population %>%
mutate(population = ...2 + ...3) %>%
rename(year = ...1) %>%
filter(year >= 2000) %>%
select(year,population)
summary(population)
####### POPULATION DATA
population  <- read_excel("data-raw/mesas-monitoring-report-2020-alcohol-sales-price-and-affordability.xlsx",
sheet = "Population data",
range = "B5:D26",
col_names = FALSE)
population <- population %>%
mutate(population = ...2 + ...3) %>%
rename(year = ...1) %>%
filter(year >= 2000) %>%
select(year,population)
####### CONSUMPTION TRENDS
### note this is UK consumption, other data is just GB so will need to adjust
### (for now a quick google search says in 2017 NI was 2.1% of UK GDP, adjust consumption
### in line with this)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)] %>%
rename(year = ...1,
consumption = ...7) %>%
mutate(consumption.gb = consumption*0.98) %>%
filter(year >= 2000)
####### SMOKING HABITS
### prevalance
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
rename(year = ...1) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance$year <- as.numeric(substr(habits.prevalance$year,1,4))
### number of cigarettes smoked
habits.ncigs <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 4",
range = "A27:U48",
col_names = FALSE)
habits.ncigs <- habits.ncigs[-c(19,20),c(1,21)] %>%
rename(year = ...1,
ncigs = ...21)
habits.ncigs$year <- as.numeric(substr(habits.ncigs$year,1,4))
### RYO vs FM
habits.type <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 5",
range = "A11:O16",
col_names = FALSE)
habits.type <- habits.type %>%
rename(year = ...1) %>%
mutate(ryo.prop = (...13+...15)/100) %>%
mutate(fm.prop = (...12+...14)/100) %>%
select(year,ryo.prop,fm.prop)
merge1 <- merge(population,consumption,by=year)
summary(consumption)
summary(population)
?merge
merge1 <- merge(population,consumption,by="year")
merge1 <- merge(population,consumption,by="year")
merge2 <- merge(merge1,habits.prevalance,by="year")
merge3 <- merge(merge2,habits.ncigs,by="year")
merge4 <- merge(merge3,habits.type,by="year")
rm(consumption,habits.prevalance,habits.ncigs,habits.type,population,merge1,merge2,merge3)
library(readxl)
library(dplyr)
####### POPULATION DATA
population  <- read_excel("data-raw/mesas-monitoring-report-2020-alcohol-sales-price-and-affordability.xlsx",
sheet = "Population data",
range = "B5:D26",
col_names = FALSE)
population <- population %>%
mutate(population = ...2 + ...3) %>%
rename(year = ...1) %>%
filter(year >= 2000) %>%
select(year,population)
####### CONSUMPTION TRENDS
### note this is UK consumption, other data is just GB so will need to adjust
### (for now a quick google search says in 2017 NI was 2.1% of UK GDP, adjust consumption
### in line with this)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)] %>%
rename(year = ...1,
consumption = ...7) %>%
mutate(consumption.gb = consumption*0.98) %>%
filter(year >= 2000)
####### SMOKING HABITS
### prevalance
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
rename(year = ...1) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance$year <- as.numeric(substr(habits.prevalance$year,1,4))
### number of cigarettes smoked
habits.ncigs <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 4",
range = "A27:U48",
col_names = FALSE)
habits.ncigs <- habits.ncigs[-c(19,20),c(1,21)] %>%
rename(year = ...1,
ncigs = ...21)
habits.ncigs$year <- as.numeric(substr(habits.ncigs$year,1,4))
### RYO vs FM
habits.type <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 5",
range = "A11:O16",
col_names = FALSE)
habits.type <- habits.type %>%
rename(year = ...1) %>%
mutate(ryo.prop = (...13+...15)/100) %>%
mutate(fm.prop = (...12+...14)/100) %>%
select(year,ryo.prop,fm.prop)
######## MERGE into one data frame
merge1 <- merge(population,consumption,by="year")
merge2 <- merge(merge1,habits.prevalance,by="year")
merge3 <- merge(merge2,habits.ncigs,by="year")
merge4 <- merge(merge3,habits.type,by="year",all = TRUE)
rm(consumption,habits.prevalance,habits.ncigs,habits.type,population,merge1,merge2,merge3)
merge4
data <- merge4 %>%
mutate(ncigs.total = ncigs*population*prevalance)
data
data <- merge4 %>%
mutate(ncigs.total = ncigs*population*prevalance*365)
data
####### POPULATION DATA
population  <- read_excel("data-raw/mesas-monitoring-report-2020-alcohol-sales-price-and-affordability.xlsx",
sheet = "Population data",
range = "B5:D26",
col_names = FALSE)
population <- population %>%
mutate(population = ...2 + ...3) %>%
rename(year = ...1) %>%
filter(year >= 2000) %>%
select(year,population)
####### CONSUMPTION TRENDS
### note this is UK consumption, other data is just GB so will need to adjust
### (for now a quick google search says in 2017 NI was 2.1% of UK GDP, adjust consumption
### in line with this)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)] %>%
rename(year = ...1,
consumption = ...7) %>%
mutate(consumption = consumption*1000000)      # convert from millions into pound units
mutate(consumption.gb = consumption*0.98) %>%
filter(year >= 2000)
####### SMOKING HABITS
### prevalance
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
rename(year = ...1) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance$year <- as.numeric(substr(habits.prevalance$year,1,4))
### number of cigarettes smoked
habits.ncigs <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 4",
range = "A27:U48",
col_names = FALSE)
habits.ncigs <- habits.ncigs[-c(19,20),c(1,21)] %>%
rename(year = ...1,
ncigs = ...21)
habits.ncigs$year <- as.numeric(substr(habits.ncigs$year,1,4))
### RYO vs FM
habits.type <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 5",
range = "A11:O16",
col_names = FALSE)
habits.type <- habits.type %>%
rename(year = ...1) %>%
mutate(ryo.prop = (...13+...15)/100) %>%
mutate(fm.prop = (...12+...14)/100) %>%
select(year,ryo.prop,fm.prop)
######## MERGE into one data frame
merge1 <- merge(population,consumption,by="year")
merge2 <- merge(merge1,habits.prevalance,by="year")
merge3 <- merge(merge2,habits.ncigs,by="year")
merge4 <- merge(merge3,habits.type,by="year",all = TRUE)
rm(consumption,habits.prevalance,habits.ncigs,habits.type,population,merge1,merge2,merge3)
####### Total Cigarettes per year = average smoked per year * number of smokers
#######                           = (average daily*365) * (population*prevalance)
data <- merge4 %>%
mutate(ncigs.total = ncigs*population*prevalance*365)
merge4
data <- merge4 %>%
mutate(ncigs.total = ncigs*population*prevalance*365) %>%
mutate(cig.price = consumption/ncigs.total)
data
hmrc <- read_excel("data-raw/hmrc tobacco bulletin.xls",
range = "B20:L24",
col_names = FALSE)
hmrc <- read_excel("data-raw/hmrc tobacco bulletin.xlsx",
range = "B20:L24",
col_names = FALSE)
hmrc <- hmrc %>%
rename(year = ...1,
FM.ncigs = ...6) %>%
mutate(...9 = ...9*1000000) %>% # convert RYO from 1000kg to grams of tobacco
mutate(FM.ncigs = FM.ncigs*1000000) %>% # convert FM from millions of sticks, to sticks
mutate(RYOpack20 = ...6/12.5) %>% # convert RYO from grams into packs of 20 FM (pack of 20 = 12.5)
mutate(RYO.ncigs = RYOpack20/20) %>% # convert RYO from packs to sticks
select(year,FM.ncigs,RYO.ncigs)
hmrc <- read_excel("data-raw/hmrc tobacco bulletin.xlsx",
range = "B20:L24",
col_names = FALSE)
hmrc <- hmrc %>%
rename(year = ...1,
FM.ncigs = ...6) %>%
mutate(FM.ncigs = FM.ncigs*1000000) %>% # convert FM from millions of sticks, to sticks
mutate(...9 = ...9*1000000) %>% # convert RYO from 1000kg to grams of tobacco
mutate(RYOpack20 = ...9/12.5) %>% # convert RYO from grams into packs of 20 FM (pack of 20 = 12.5)
mutate(RYO.ncigs = RYOpack20/20) %>% # convert RYO from packs to sticks
select(year,FM.ncigs,RYO.ncigs)
library(readxl)
library(dplyr)
####### POPULATION DATA
population  <- read_excel("data-raw/mesas-monitoring-report-2020-alcohol-sales-price-and-affordability.xlsx",
sheet = "Population data",
range = "B5:D26",
col_names = FALSE)
population <- population %>%
mutate(population = ...2 + ...3) %>%
rename(year = ...1) %>%
filter(year >= 2000) %>%
select(year,population)
####### CONSUMPTION TRENDS
### note this is UK consumption, other data is just GB so will need to adjust
### (for now a quick google search says in 2017 NI was 2.1% of UK GDP, adjust consumption
### in line with this)
consumption <- read_excel("data-raw/consumertrendsq12020cvmsa.xls",
sheet = "02KS",
range = "A13:G35",
col_names = FALSE)
consumption <- consumption[,c(1,7)] %>%
rename(year = ...1,
consumption = ...7) %>%
mutate(consumption = consumption*1000000)      # convert from millions into pound units
mutate(consumption.gb = consumption*0.98) %>%
filter(year >= 2000)
####### SMOKING HABITS
### prevalance
habits.prevalance <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 1",
range = "A27:U46",
col_names = FALSE)
habits.prevalance <- habits.prevalance[,c(1,21)] %>%
rename(year = ...1) %>%
mutate(prevalance = ...21/100) %>%
select(year,prevalance)
habits.prevalance$year <- as.numeric(substr(habits.prevalance$year,1,4))
### number of cigarettes smoked
habits.ncigs <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 4",
range = "A27:U48",
col_names = FALSE)
habits.ncigs <- habits.ncigs[-c(19,20),c(1,21)] %>%
rename(year = ...1,
ncigs = ...21)
habits.ncigs$year <- as.numeric(substr(habits.ncigs$year,1,4))
### RYO vs FM
habits.type <- read_excel("data-raw/adultsmokinghabitsingreatbritain2019final.xls",
sheet = "Table 5",
range = "A11:O16",
col_names = FALSE)
habits.type <- habits.type %>%
rename(year = ...1) %>%
mutate(ryo.prop = (...13+...15)/100) %>%
mutate(fm.prop = (...12+...14)/100) %>%
select(year,ryo.prop,fm.prop)
### HMRC quantity data
hmrc <- read_excel("data-raw/hmrc tobacco bulletin.xlsx",
range = "B20:L24",
col_names = FALSE)
hmrc <- hmrc %>%
rename(year = ...1,
FM.ncigs = ...6) %>%
mutate(FM.ncigs = FM.ncigs*1000000) %>% # convert FM from millions of sticks, to sticks
mutate(...9 = ...9*1000000) %>% # convert RYO from 1000kg to grams of tobacco
mutate(RYOpack20 = ...9/12.5) %>% # convert RYO from grams into packs of 20 FM (pack of 20 = 12.5)
mutate(RYO.ncigs = RYOpack20/20) %>% # convert RYO from packs to sticks
select(year,FM.ncigs,RYO.ncigs)
######## MERGE into one data frame
merge1 <- merge(population,consumption,by="year")
merge2 <- merge(merge1,habits.prevalance,by="year")
merge3 <- merge(merge2,habits.ncigs,by="year")
merge4 <- merge(merge3,habits.type,by="year",all = TRUE)
merge5 <- merge(merge5,hmrc,by="year",all = TRUE)
merge5 <- merge(merge4,hmrc,by="year",all = TRUE)
merge5
rm(consumption,habits.prevalance,habits.ncigs,habits.type,population,merge1,merge2,merge3,merge4)
