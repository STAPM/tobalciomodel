range = "C6:C110",
col_names = FALSE)
govtdemand2005 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2005",
range = "E6:E110",
col_names = FALSE)
finaldemand2005 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2005",
range = "T6:T110",
col_names = FALSE)
hholdoutput2005 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2005",
range = "C113:DC113",
col_names = FALSE))
hholdoutput2005 <- data.frame(hholdoutput2005)
totaloutput2005 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2005",
range = "C116:DC116",
col_names = FALSE))
totaloutput2005 <- data.frame(totaloutput2005)
totaldemand2005 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2005",
range = "V6:V110",
col_names = FALSE)
gva2005 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2005",
range = "C112:DC115",
col_names = FALSE))
gva2005 <- data.frame(gva2005)
setDT(iotable2005)
setDT(hholddemand2005)
setDT(govtdemand2005)
setDT(finaldemand2005)
setDT(hholdoutput2005)
setDT(totaloutput2005)
setDT(totaldemand2005)
setDT(gva2005)
setnames(iotable2005, old = names(iotable2005), new = paste0("sec",c(1:105)) )
setnames(hholddemand2005, old = names(hholddemand2005), new = c("hhold.demand"))
setnames(govtdemand2005 , old = names(govtdemand2005) , new = c("govt.demand"))
setnames(finaldemand2005, old = names(finaldemand2005), new = c("final.demand"))
setnames(hholdoutput2005, old = names(hholdoutput2005), new = c("hhold.output"))
setnames(totaloutput2005, old = names(totaloutput2005), new = c("total.output"))
setnames(totaldemand2005, old = names(totaldemand2005), new = c("total.demand"))
setnames(gva2005        , old = names(gva2005)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data2005 <- cbind(sector,iotable2005,hholddemand2005,govtdemand2005,finaldemand2005,hholdoutput2005,totaloutput2005,totaldemand2005,gva2005)
data2005[, year := 2005]
rm(iotable2005,hholddemand2005,govtdemand2005,finaldemand2005,hholdoutput2005,totaloutput2005,totaldemand2005,gva2005)
## 2004
iotable2004 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2004",
range = "C6:DC110",
col_names = FALSE)
hholddemand2004 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2004",
range = "C6:C110",
col_names = FALSE)
govtdemand2004 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2004",
range = "E6:E110",
col_names = FALSE)
finaldemand2004 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2004",
range = "T6:T110",
col_names = FALSE)
hholdoutput2004 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2004",
range = "C113:DC113",
col_names = FALSE))
hholdoutput2004 <- data.frame(hholdoutput2004)
totaloutput2004 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2004",
range = "C116:DC116",
col_names = FALSE))
totaloutput2004 <- data.frame(totaloutput2004)
totaldemand2004 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2004",
range = "V6:V110",
col_names = FALSE)
gva2004 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2004",
range = "C112:DC115",
col_names = FALSE))
gva2004 <- data.frame(gva2004)
setDT(iotable2004)
setDT(hholddemand2004)
setDT(govtdemand2004)
setDT(finaldemand2004)
setDT(hholdoutput2004)
setDT(totaloutput2004)
setDT(totaldemand2004)
setDT(gva2004)
setnames(iotable2004, old = names(iotable2004), new = paste0("sec",c(1:105)) )
setnames(hholddemand2004, old = names(hholddemand2004), new = c("hhold.demand"))
setnames(govtdemand2004 , old = names(govtdemand2004) , new = c("govt.demand"))
setnames(finaldemand2004, old = names(finaldemand2004), new = c("final.demand"))
setnames(hholdoutput2004, old = names(hholdoutput2004), new = c("hhold.output"))
setnames(totaloutput2004, old = names(totaloutput2004), new = c("total.output"))
setnames(totaldemand2004, old = names(totaldemand2004), new = c("total.demand"))
setnames(gva2004        , old = names(gva2004)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data2004 <- cbind(sector,iotable2004,hholddemand2004,govtdemand2004,finaldemand2004,hholdoutput2004,totaloutput2004,totaldemand2004,gva2004)
data2004[, year := 2004]
rm(iotable2004,hholddemand2004,govtdemand2004,finaldemand2004,hholdoutput2004,totaloutput2004,totaldemand2004,gva2004)
## 2003
iotable2003 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2003",
range = "C6:DC110",
col_names = FALSE)
hholddemand2003 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2003",
range = "C6:C110",
col_names = FALSE)
govtdemand2003 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2003",
range = "E6:E110",
col_names = FALSE)
finaldemand2003 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2003",
range = "T6:T110",
col_names = FALSE)
hholdoutput2003 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2003",
range = "C113:DC113",
col_names = FALSE))
hholdoutput2003 <- data.frame(hholdoutput2003)
totaloutput2003 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2003",
range = "C116:DC116",
col_names = FALSE))
totaloutput2003 <- data.frame(totaloutput2003)
totaldemand2003 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2003",
range = "V6:V110",
col_names = FALSE)
gva2003 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2003",
range = "C112:DC115",
col_names = FALSE))
gva2003 <- data.frame(gva2003)
setDT(iotable2003)
setDT(hholddemand2003)
setDT(govtdemand2003)
setDT(finaldemand2003)
setDT(hholdoutput2003)
setDT(totaloutput2003)
setDT(totaldemand2003)
setDT(gva2003)
setnames(iotable2003, old = names(iotable2003), new = paste0("sec",c(1:105)) )
setnames(hholddemand2003, old = names(hholddemand2003), new = c("hhold.demand"))
setnames(govtdemand2003 , old = names(govtdemand2003) , new = c("govt.demand"))
setnames(finaldemand2003, old = names(finaldemand2003), new = c("final.demand"))
setnames(hholdoutput2003, old = names(hholdoutput2003), new = c("hhold.output"))
setnames(totaloutput2003, old = names(totaloutput2003), new = c("total.output"))
setnames(totaldemand2003, old = names(totaldemand2003), new = c("total.demand"))
setnames(gva2003        , old = names(gva2003)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data2003 <- cbind(sector,iotable2003,hholddemand2003,govtdemand2003,finaldemand2003,hholdoutput2003,totaloutput2003,totaldemand2003,gva2003)
data2003[, year := 2003]
rm(iotable2003,hholddemand2003,govtdemand2003,finaldemand2003,hholdoutput2003,totaloutput2003,totaldemand2003,gva2003)
## 2002
iotable2002 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2002",
range = "C6:DC110",
col_names = FALSE)
hholddemand2002 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2002",
range = "C6:C110",
col_names = FALSE)
govtdemand2002 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2002",
range = "E6:E110",
col_names = FALSE)
finaldemand2002 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2002",
range = "T6:T110",
col_names = FALSE)
hholdoutput2002 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2002",
range = "C113:DC113",
col_names = FALSE))
hholdoutput2002 <- data.frame(hholdoutput2002)
totaloutput2002 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2002",
range = "C116:DC116",
col_names = FALSE))
totaloutput2002 <- data.frame(totaloutput2002)
totaldemand2002 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2002",
range = "V6:V110",
col_names = FALSE)
gva2002 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2002",
range = "C112:DC115",
col_names = FALSE))
gva2002 <- data.frame(gva2002)
setDT(iotable2002)
setDT(hholddemand2002)
setDT(govtdemand2002)
setDT(finaldemand2002)
setDT(hholdoutput2002)
setDT(totaloutput2002)
setDT(totaldemand2002)
setDT(gva2002)
setnames(iotable2002, old = names(iotable2002), new = paste0("sec",c(1:105)) )
setnames(hholddemand2002, old = names(hholddemand2002), new = c("hhold.demand"))
setnames(govtdemand2002 , old = names(govtdemand2002) , new = c("govt.demand"))
setnames(finaldemand2002, old = names(finaldemand2002), new = c("final.demand"))
setnames(hholdoutput2002, old = names(hholdoutput2002), new = c("hhold.output"))
setnames(totaloutput2002, old = names(totaloutput2002), new = c("total.output"))
setnames(totaldemand2002, old = names(totaldemand2002), new = c("total.demand"))
setnames(gva2002        , old = names(gva2002)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data2002 <- cbind(sector,iotable2002,hholddemand2002,govtdemand2002,finaldemand2002,hholdoutput2002,totaloutput2002,totaldemand2002,gva2002)
data2002[, year := 2002]
rm(iotable2002,hholddemand2002,govtdemand2002,finaldemand2002,hholdoutput2002,totaloutput2002,totaldemand2002,gva2002)
## 2001
iotable2001 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2001",
range = "C6:DC110",
col_names = FALSE)
hholddemand2001 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2001",
range = "C6:C110",
col_names = FALSE)
govtdemand2001 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2001",
range = "E6:E110",
col_names = FALSE)
finaldemand2001 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2001",
range = "T6:T110",
col_names = FALSE)
hholdoutput2001 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2001",
range = "C113:DC113",
col_names = FALSE))
hholdoutput2001 <- data.frame(hholdoutput2001)
totaloutput2001 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2001",
range = "C116:DC116",
col_names = FALSE))
totaloutput2001 <- data.frame(totaloutput2001)
totaldemand2001 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2001",
range = "V6:V110",
col_names = FALSE)
gva2001 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2001",
range = "C112:DC115",
col_names = FALSE))
gva2001 <- data.frame(gva2001)
setDT(iotable2001)
setDT(hholddemand2001)
setDT(govtdemand2001)
setDT(finaldemand2001)
setDT(hholdoutput2001)
setDT(totaloutput2001)
setDT(totaldemand2001)
setDT(gva2001)
setnames(iotable2001, old = names(iotable2001), new = paste0("sec",c(1:105)) )
setnames(hholddemand2001, old = names(hholddemand2001), new = c("hhold.demand"))
setnames(govtdemand2001 , old = names(govtdemand2001) , new = c("govt.demand"))
setnames(finaldemand2001, old = names(finaldemand2001), new = c("final.demand"))
setnames(hholdoutput2001, old = names(hholdoutput2001), new = c("hhold.output"))
setnames(totaloutput2001, old = names(totaloutput2001), new = c("total.output"))
setnames(totaldemand2001, old = names(totaldemand2001), new = c("total.demand"))
setnames(gva2001        , old = names(gva2001)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data2001 <- cbind(sector,iotable2001,hholddemand2001,govtdemand2001,finaldemand2001,hholdoutput2001,totaloutput2001,totaldemand2001,gva2001)
data2001[, year := 2001]
rm(iotable2001,hholddemand2001,govtdemand2001,finaldemand2001,hholdoutput2001,totaloutput2001,totaldemand2001,gva2001)
## 2000
iotable2000 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2000",
range = "C6:DC110",
col_names = FALSE)
hholddemand2000 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2000",
range = "C6:C110",
col_names = FALSE)
govtdemand2000 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2000",
range = "E6:E110",
col_names = FALSE)
finaldemand2000 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2000",
range = "T6:T110",
col_names = FALSE)
hholdoutput2000 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2000",
range = "C113:DC113",
col_names = FALSE))
hholdoutput2000 <- data.frame(hholdoutput2000)
totaloutput2000 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2000",
range = "C116:DC116",
col_names = FALSE))
totaloutput2000 <- data.frame(totaloutput2000)
totaldemand2000 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 2000",
range = "V6:V110",
col_names = FALSE)
gva2000 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 2000",
range = "C112:DC115",
col_names = FALSE))
gva2000 <- data.frame(gva2000)
setDT(iotable2000)
setDT(hholddemand2000)
setDT(govtdemand2000)
setDT(finaldemand2000)
setDT(hholdoutput2000)
setDT(totaloutput2000)
setDT(totaldemand2000)
setDT(gva2000)
setnames(iotable2000, old = names(iotable2000), new = paste0("sec",c(1:105)) )
setnames(hholddemand2000, old = names(hholddemand2000), new = c("hhold.demand"))
setnames(govtdemand2000 , old = names(govtdemand2000) , new = c("govt.demand"))
setnames(finaldemand2000, old = names(finaldemand2000), new = c("final.demand"))
setnames(hholdoutput2000, old = names(hholdoutput2000), new = c("hhold.output"))
setnames(totaloutput2000, old = names(totaloutput2000), new = c("total.output"))
setnames(totaldemand2000, old = names(totaldemand2000), new = c("total.demand"))
setnames(gva2000        , old = names(gva2000)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data2000 <- cbind(sector,iotable2000,hholddemand2000,govtdemand2000,finaldemand2000,hholdoutput2000,totaloutput2000,totaldemand2000,gva2000)
data2000[, year := 2000]
rm(iotable2000,hholddemand2000,govtdemand2000,finaldemand2000,hholdoutput2000,totaloutput2000,totaldemand2000,gva2000)
## 1999
iotable1999 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1999",
range = "C6:DC110",
col_names = FALSE)
hholddemand1999 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1999",
range = "C6:C110",
col_names = FALSE)
govtdemand1999 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1999",
range = "E6:E110",
col_names = FALSE)
finaldemand1999 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1999",
range = "T6:T110",
col_names = FALSE)
hholdoutput1999 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1999",
range = "C113:DC113",
col_names = FALSE))
hholdoutput1999 <- data.frame(hholdoutput1999)
totaloutput1999 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1999",
range = "C116:DC116",
col_names = FALSE))
totaloutput1999 <- data.frame(totaloutput1999)
totaldemand1999 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1999",
range = "V6:V110",
col_names = FALSE)
gva1999 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1999",
range = "C112:DC115",
col_names = FALSE))
gva1999 <- data.frame(gva1999)
setDT(iotable1999)
setDT(hholddemand1999)
setDT(govtdemand1999)
setDT(finaldemand1999)
setDT(hholdoutput1999)
setDT(totaloutput1999)
setDT(totaldemand1999)
setDT(gva1999)
setnames(iotable1999, old = names(iotable1999), new = paste0("sec",c(1:105)) )
setnames(hholddemand1999, old = names(hholddemand1999), new = c("hhold.demand"))
setnames(govtdemand1999 , old = names(govtdemand1999) , new = c("govt.demand"))
setnames(finaldemand1999, old = names(finaldemand1999), new = c("final.demand"))
setnames(hholdoutput1999, old = names(hholdoutput1999), new = c("hhold.output"))
setnames(totaloutput1999, old = names(totaloutput1999), new = c("total.output"))
setnames(totaldemand1999, old = names(totaldemand1999), new = c("total.demand"))
setnames(gva1999        , old = names(gva1999)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data1999 <- cbind(sector,iotable1999,hholddemand1999,govtdemand1999,finaldemand1999,hholdoutput1999,totaloutput1999,totaldemand1999,gva1999)
data1999[, year := 1999]
rm(iotable1999,hholddemand1999,govtdemand1999,finaldemand1999,hholdoutput1999,totaloutput1999,totaldemand1999,gva1999)
## 1998
iotable1998 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1998",
range = "C6:DC110",
col_names = FALSE)
hholddemand1998 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1998",
range = "C6:C110",
col_names = FALSE)
govtdemand1998 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1998",
range = "E6:E110",
col_names = FALSE)
finaldemand1998 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1998",
range = "T6:T110",
col_names = FALSE)
hholdoutput1998 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1998",
range = "C113:DC113",
col_names = FALSE))
hholdoutput1998 <- data.frame(hholdoutput1998)
totaloutput1998 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1998",
range = "C116:DC116",
col_names = FALSE))
totaloutput1998 <- data.frame(totaloutput1998)
totaldemand1998 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1998",
range = "V6:V110",
col_names = FALSE)
gva1998 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1998",
range = "C112:DC115",
col_names = FALSE))
gva1998 <- data.frame(gva1998)
setDT(iotable1998)
setDT(hholddemand1998)
setDT(govtdemand1998)
setDT(finaldemand1998)
setDT(hholdoutput1998)
setDT(totaloutput1998)
setDT(totaldemand1998)
setDT(gva1998)
setnames(iotable1998, old = names(iotable1998), new = paste0("sec",c(1:105)) )
setnames(hholddemand1998, old = names(hholddemand1998), new = c("hhold.demand"))
setnames(govtdemand1998 , old = names(govtdemand1998) , new = c("govt.demand"))
setnames(finaldemand1998, old = names(finaldemand1998), new = c("final.demand"))
setnames(hholdoutput1998, old = names(hholdoutput1998), new = c("hhold.output"))
setnames(totaloutput1998, old = names(totaloutput1998), new = c("total.output"))
setnames(totaldemand1998, old = names(totaldemand1998), new = c("total.demand"))
setnames(gva1998        , old = names(gva1998)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data1998 <- cbind(sector,iotable1998,hholddemand1998,govtdemand1998,finaldemand1998,hholdoutput1998,totaloutput1998,totaldemand1998,gva1998)
data1998[, year := 1998]
rm(iotable1998,hholddemand1998,govtdemand1998,finaldemand1998,hholdoutput1998,totaloutput1998,totaldemand1998,gva1998)
## 1997
iotable1997 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1997",
range = "C6:DC110",
col_names = FALSE)
hholddemand1997 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1997",
range = "C6:C110",
col_names = FALSE)
govtdemand1997 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1997",
range = "E6:E110",
col_names = FALSE)
finaldemand1997 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1997",
range = "T6:T110",
col_names = FALSE)
hholdoutput1997 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1997",
range = "C113:DC113",
col_names = FALSE))
hholdoutput1997 <- data.frame(hholdoutput1997)
totaloutput1997 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1997",
range = "C116:DC116",
col_names = FALSE))
totaloutput1997 <- data.frame(totaloutput1997)
totaldemand1997 <- read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Final Demand 1997",
range = "V6:V110",
col_names = FALSE)
gva1997 <- t(read_excel(paste0(filepath,"1997 - 2018 ONS IO tables.xlsx"),
sheet = "Table 2 - Int Con 1997",
range = "C112:DC115",
col_names = FALSE))
gva1997 <- data.frame(gva1997)
setDT(iotable1997)
setDT(hholddemand1997)
setDT(govtdemand1997)
setDT(finaldemand1997)
setDT(hholdoutput1997)
setDT(totaloutput1997)
setDT(totaldemand1997)
setDT(gva1997)
setnames(iotable1997, old = names(iotable1997), new = paste0("sec",c(1:105)) )
setnames(hholddemand1997, old = names(hholddemand1997), new = c("hhold.demand"))
setnames(govtdemand1997 , old = names(govtdemand1997) , new = c("govt.demand"))
setnames(finaldemand1997, old = names(finaldemand1997), new = c("final.demand"))
setnames(hholdoutput1997, old = names(hholdoutput1997), new = c("hhold.output"))
setnames(totaloutput1997, old = names(totaloutput1997), new = c("total.output"))
setnames(totaldemand1997, old = names(totaldemand1997), new = c("total.demand"))
setnames(gva1997        , old = names(gva1997)        , new = c("gva.taxes","gva.wages","gva.gos","gva.total"))
data1997 <- cbind(sector,iotable1997,hholddemand1997,govtdemand1997,finaldemand1997,hholdoutput1997,totaloutput1997,totaldemand1997,gva1997)
data1997[, year := 1997]
rm(iotable1997,hholddemand1997,govtdemand1997,finaldemand1997,hholdoutput1997,totaloutput1997,totaldemand1997,gva1997)
###### combine all data tables into one
iotables <- rbind(data1997,data1998,data1999,
data2000,data2001,data2002,data2003,data2004,
data2005,data2006,data2007,data2008,data2009,
data2010,data2011,data2012,data2013,data2014,
data2015,data2016,data2017,data2018)
rm(sector,        data1997,data1998,data1999,
data2000,data2001,data2002,data2003,data2004,
data2005,data2006,data2007,data2008,data2009,
data2010,data2011,data2012,data2013,data2014,
data2015,data2016,data2017,data2018)
setnames(iotables,c("sector"),c("name"))
data_iotables_ons <- iotables
usethis::use_data(data_iotables_ons,overwrite=TRUE)
devtools::document()
names(data_iotables_ons)
library(tobalciomodel)
devtools::document()
library(tobalciomodel)
help(package = tobalciomodel)
help(package = tobalciomodel)
tobalciomodel::macro
usethis::use_gpl3_license()
usethis::use_gpl3_license(name = "Damon Morris")
